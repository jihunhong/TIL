# ğŸ’€ Exception

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
<!-- code_chunk_output -->

* [ğŸ’€ Exception](#exception)
	* [Checked Exception / UnChecked Exception](#checked-exception-unchecked-exception)
	* [Serviceì™€ Exception](#serviceì™€-exception)
		* [â“ ê·¸ëŸ¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ í• ê¹Œ](#ê·¸ëŸ¼-ì–´ë–»ê²Œ-ì²˜ë¦¬í•´ì•¼-í• ê¹Œ)

<!-- /code_chunk_output -->


## Checked Exception / UnChecked Exception

|Checked Exception   | UnChecked Exception  |
|---|---|
| ì—„ê²©í•œ ì˜ˆì™¸ì²˜ë¦¬ ê³¼ì •   | ê°•ì œí•˜ì§€ ì•ŠëŠ” ì²˜ë¦¬ê³¼ì •  |
|ì»´íŒŒì¼ ë‹¨ê³„|ì‹¤í–‰ë‹¨ê³„|
|roll-back âŒ| roll-back â­•|
|RuntimeExceptionì„ ì œì™¸í•œ ëª¨ë“  ì˜ˆì™¸|RuntimeException ì˜ í•˜ìœ„ ì˜ˆì™¸|


## Serviceì™€ Exception
> ëŒ€ê°œ Serviceê³„ì¸µì—ì„œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ë³¸ ëª©ì ì— ë§ê²Œ Exceptionì²˜ë¦¬ëŠ” í•˜ì§€ ì•ŠëŠ”ë‹¤.
ì´ ë§ì€ í•„ìˆ˜ì ì¸ ê²ƒ ê³¼ëŠ” ë‹¤ë¥¸ ì˜ë¯¸ë¡œì¨ Exceptionì²˜ë¦¬ì˜ í•„ìš”ì„±ì´ ì—†ë‹¤ê³  ì´í•´í•˜ê³  ë„˜ì–´ê°€ì.

### â“ ê·¸ëŸ¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ í• ê¹Œ
> Serviceì™€ Controller ê³„ì¸µì—ì„œ ì²˜ë¦¬í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ **DAOì—ì„œ Exceptionì²˜ë¦¬ê°€ ì´ë£¨ì–´ì§„ë‹¤.**
[ì˜ˆì œ](https://github.com/jihunhong/mysite2/blob/master/src/main/java/com/cafe24/mysite/repository/UserDao.java)ì˜ UserDAOì— SQLExceptionì€ ì²˜ë¦¬ëŠ” Exceptionì„ ìƒì†ë°›ì•„ ì§ì ‘ ì •ì˜í•œ [UserDAOException í´ë˜ìŠ¤](https://github.com/jihunhong/mysite2/blob/master/src/main/java/com/cafe24/mysite/exception/UserDAOException.java)ì—ì„œ `RuntimeException`ì„ ì‚¬ìš©í•´ ì „í™˜í•˜ëŠ”ê²ƒìœ¼ë¡œ ì´ë£¨ì–´ì¡Œë‹¤.

```java
try{
		~
} catch (SQLException e) {
   throw new UserDAOException();
	 //ì›ë˜ëŠ” RuntimeException.
}
```
- ì´ì²˜ëŸ¼ @ExceptionHandler Annotationì„ ì‚¬ìš©í•œ Exception í•¸ë“¤ëŸ¬ ë§¤í•‘ì€ ê°œë³„ì ì¸ ì˜ˆì™¸ì²˜ë¦¬ ë³´ë‹¤
- **ëª¨ë“  Exceptionì„ í•œ ë©”ì„œë“œì—ì„œ ì²˜ë¦¬** í•  ìˆ˜ ìˆë‹¤ëŠ” ì  `@ExceptionHandler(Exception.class )`
- í•´ë‹¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê°™ì€ ì¢…ë¥˜ì˜ ì˜ˆì™¸ì²˜ë¦¬ë¡œ ì¸í•œ ë³µêµ¬ì˜ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤ëŠ”ì 
- ê°ê°ì˜ ë‹¤ë¥¸ ì˜ˆì™¸ìƒí™©ë“¤ì— ê´€í•´ ê°ê¸° ë‹¤ë¥¸ ë·°ë¥¼ ë°˜í™˜ í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

```Java

@ExceptionHandler( Exception.class )
public void HandlerDAOException( HttpServletRequest request, HttpServletResponse response, Exception e) throws Exception {\
		// 1. ë¡œê¹…
		e.printStackTrace();
		StringWriter errors = new StringWriter();

		e.printStackTrace(new PrintWriter(errors));

		LOGGER.error(errors.toString());

		System.out.println(errors.toString());


		String accept = request.getHeader("accept");

		if(accept.matches(".*application/json.*")) {
			// JSON ì‘ë‹µ

			response.setStatus(HttpServletResponse.SC_OK);

			JSONResult jsonresult = JSONResult.fail(errors.toString());

			String result = new ObjectMapper().writeValueAsString(jsonresult);

			System.out.println(result);

			OutputStream os = response.getOutputStream();
			os.write(result.getBytes());
			os.close();

		}else {
			//2. ì•ˆë‚´í˜ì´ì§€ ê°€ê¸° + ì •ìƒì¢…ë£Œ(response)
			request.setAttribute("uri", request.getRequestURI());
			request.setAttribute("exception", errors);

			request.getRequestDispatcher("/WEB-INF/views/error/exception.jsp").forward(request, response);
		}
	}
```
